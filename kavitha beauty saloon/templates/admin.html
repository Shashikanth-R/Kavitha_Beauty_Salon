<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Kavitha Beauty Salon</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        body {
            min-height: 100vh;
            margin: 0;
            background:
              linear-gradient(105deg, #ffe2f8cc 33%, #faf7fbcc 88%),
              url('/static/css/js/images/canvabg2.png') center center/cover no-repeat;
        }
        .admin-section {
            margin-bottom: 2em;
            max-width: 1100px;
            margin-left: auto;
            margin-right: auto;
            padding: 0 16px;
        }
        .admin-table {
            width: 100%;
            max-width: 100%;
            table-layout: auto;
            border-collapse: collapse;
            background: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            border-radius: 8px;
            overflow-x: auto;
            display: block;
        }
        .admin-table th, .admin-table td {
            border: 1px solid #c7c7c7;
            padding: 8px;
            text-align: left;
            vertical-align: top;
            word-break: break-word;
        }
        .admin-table th {
            background: #efefef;
        }
        .phone-col {
            min-width: 120px;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <header>
        <h1>Admin Panel</h1>
    </header>
    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/services">Services</a></li>
            <li><a href="/gallery">Gallery</a></li>
            <li><a href="/booking">Booking</a></li>
            <li><a href="/contact">Contact</a></li>
            <li><a href="/admin">Admin</a></li>
            <li><a href="/logout">Logout</a></li>
        </ul>
    </nav>
    <main>
        <section class="admin-section">
            <h2>Manage Bookings</h2>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>SL No</th>
                        <th style="min-width:180px; white-space:normal;">Name</th>
                        <th style="min-width:180px; white-space:normal;">Email</th>
                        <th class="phone-col">Phone</th>
                        <th style="min-width:180px; white-space:normal;">Service</th>
                        <th style="min-width:120px; white-space:normal;">Date</th>
                        <th style="min-width:140px; white-space:normal;">Slot Timing</th>
                        <th style="min-width:120px; white-space:normal;">Total Amount</th>
                        <th>Amount Paid</th>
                        <th>Confirmed</th>
                    </tr>
                </thead>
                <tbody>
                    {% if appointments %}
                    {% for a in appointments %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td style="white-space:normal;">{{ a.name }}</td>
                        <td style="white-space:normal;">{{ a.email }}</td>
                        <td class="phone-col">{{ a.phone }}</td>
                        <td style="white-space:normal;">{{ a.service }}</td>
                        <td style="white-space:normal;">{{ a.date }}</td>
                        <td>{{ a.slot }}</td>
                        <td>{{ a.total_amount }}</td>
                        <td>
                          <form method="POST" action="/admin" style="margin:0;padding:0;display:inline-block;">
                            <input type="hidden" name="appt_id" value="{{ a.id }}">
                            <select name="amount_paid" onchange="this.form.submit()">
                              <option value="1" {% if a.amount_paid %}selected{% endif %}>Yes</option>
                              <option value="0" {% if not a.amount_paid %}selected{% endif %}>No</option>
                            </select>
                          </form>
                        </td>
                        <td>
                          <form method="POST" action="/admin/confirm" style="margin:0;padding:0;display:inline-block;">
                            <input type="hidden" name="appt_id" value="{{ a.id }}">
                            <select name="confirmed" onchange="this.form.submit()">
                              <option value="1" {% if a.confirmed %}selected{% endif %}>Yes</option>
                              <option value="0" {% if not a.confirmed %}selected{% endif %}>No</option>
                            </select>
                          </form>
                        </td>
                    </tr>
                    {% endfor %}
                    {% else %}
                    <tr><td colspan="9" style="text-align:center;">No appointments found</td></tr>
                    {% endif %}
                </tbody>
            </table>
        </section>

        <section class="admin-section">
            <h2>Messages from Customers</h2>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>SL No</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Message</th>
                        <th>Date/Time</th>
                    </tr>
                </thead>
                <tbody>
                    {% if messages %}
                    {% for m in messages %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ m.name }}</td>
                        <td>{{ m.email }}</td>
                        <td>{{ m.message }}</td>
                        <td>{{ m.submitted_at }}</td>
                    </tr>
                    {% endfor %}
                    {% else %}
                    <tr><td colspan="5" style="text-align:center;">No messages found</td></tr>
                    {% endif %}
                </tbody>
            </table>
        </section>
    </main>
    <footer>
        <p>&copy; 2025 Kavitha Beauty Salon. All rights reserved.</p>
    </footer>
    <script src="/static/js/main.js"></script>
</body>
</html>